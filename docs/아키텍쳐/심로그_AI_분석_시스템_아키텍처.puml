@startuml 심로그_AI_분석_시스템_아키텍처

!theme plain
skinparam backgroundColor #FFFFFF
skinparam defaultFontName Arial
skinparam defaultFontSize 10

title 심로그 AI 분석 시스템 아키텍처

package "Frontend (Flutter)" {
  [감정 기록 화면] as UI
  [음성 녹음] as Voice
  [텍스트 입력] as Text
}

package "Backend (FastAPI)" {
  [AI Analysis Service] as AI
  [Emotion Color Service] as Color
  [Record Service] as Record
  [User Service] as User
}

package "External APIs" {
  [OpenAI GPT-4o mini] as GPT
  [NAVER CLOVA Speech] as CLOVA
}

database "Database" {
  [Users] as DB_Users
  [Records] as DB_Records
  [Emotions] as DB_Emotions
}

' Frontend to Backend
UI --> AI : 감정 분석 요청
Voice --> AI : 음성 파일
Text --> AI : 텍스트 데이터

' Backend Services
AI --> GPT : 텍스트 감정 분석
AI --> CLOVA : 음성 인식
AI --> Color : 색상 변환
AI --> Record : 기록 저장
AI --> User : 사용자 정보

' Fallback Mechanism
AI --> Color : 기본 키워드 분석 (폴백)

' Database Operations
Record --> DB_Records : 저장/조회
User --> DB_Users : 사용자 관리
Color --> DB_Emotions : 감정 통계

' Data Flow
note right of AI
**감정 분석 프로세스:**
1. 텍스트/음성 입력
2. GPT-4o mini 분석
3. 감정 분류 (8가지)
4. 강도/확신도 계산
5. 색상 매핑
6. 결과 반환
end note

note left of Color
**색상 매핑:**
- 8가지 기본 감정
- 파스텔 톤 색상
- 강도별 밝기 조정
- RGB/HEX 변환
end note

note bottom of GPT
**GPT-4o mini 설정:**
- model: gpt-4o-mini
- temperature: 0.3
- max_tokens: 제한 없음
- JSON 응답 형식
end note

@enduml 