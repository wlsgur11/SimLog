# SimLog (심로그) 화면별 기능 명세서

**AI가 읽는 마음, 함께 자라는 정원**

---

## 목차

1. [화면별 상세 기능](#1-화면별-상세-기능)
2. [API 명세서](#2-api-명세서)

---

## 1. 화면별 상세 기능

### 1.1 스플래시 화면 (Splash Screen)
- **기능**: 앱 시작 시 로딩 및 초기화
- **동작**: 자동 로그인 확인, 토큰 유효성 검증
- **전환**: 홈 화면 또는 로그인 화면으로 자동 이동

### 1.2 로그인 화면 (Login Screen)
- **기능**: 사용자 인증 및 로그인
- **입력 필드**: 이메일, 비밀번호
- **유효성 검사**: 실시간 입력 검증
- **에러 처리**: 로그인 실패 시 명확한 피드백

### 1.3 홈 화면 (Home Screen)
- **기능**: 메인 네비게이션 및 사용자 정보 표시
- **구성 요소**: 
  - 사용자 닉네임 및 씨앗 정보
  - 빠른 액세스 버튼 (일기 작성, 마음 정원, 마음 체크)
  - 7일 감정 알림 모달
- **애니메이션**: 페이드인, 슬라이드, 바운스 효과

### 1.4 일기 작성 화면 (Emotion Record Screen)
- **기능**: 감정 기록 및 AI 분석
- **입력 요소**:
  - 수면 품질 슬라이더 (1-10)
  - 스트레스 정도 슬라이더 (1-10)
  - 일기 내용 텍스트 입력
  - 음성 입력 버튼
- **AI 분석**: 작성 완료 시 자동 감정 분석
- **로딩 화면**: 분석 진행 상태 표시

### 1.5 일기 결과 화면 (Diary Result Screen)
- **기능**: AI 분석 결과 표시
- **표시 내용**:
  - 감정 색상 및 강도
  - AI 추출 키워드
  - 감정 요약
  - 신뢰도 점수
- **공유 옵션**: 상담사와의 공유 동의

### 1.6 감정 분석 화면 (Analysis Screen)
- **기능**: 감정 변화 추이 및 통계
- **차트 유형**:
  - 7일 감정 변화 그래프
  - 감정 분포 파이 차트
  - 월간 감정 통계
- **필터링**: 기간별, 감정별 분석

### 1.7 마음 정원 화면 (Garden Screen)
- **기능**: 게임형 마음 건강 관리
- **구성 요소**:
  - **정원 탭**: 6x12 그리드 정원
  - **내 씨앗 탭**: 출석 체크 및 씨앗 정보
  - **상점 탭**: 아이템 구매 (씨앗 사용)
  - **인벤토리 탭**: 보유 아이템 관리
- **게임 메커니즘**:
  - 출석 체크 시 기본 2개 + 연속 출석 보너스 (최대 8개)
  - 연속 출석 보너스: 2일(2개), 4일(4개), 6일(6개), 7일+(8개)
  - 7일마다 특별 보너스 5개 추가
  - 아이템 배치 및 제거
  - 레이어별 정렬

### 1.8 마음 체크 화면 (Mind Check Screen)
- **기능**: 효원 상담원 연결 및 위험 신호 알림
- **상담 연결**: Google Forms 기반 상담 신청
- **알림 시스템**: 7일 부정 감정 지속 시 모달 표시
- **동의 옵션**: "동의 없이 바로가기" / "동의하고 바로가기"

### 1.9 프로필 화면 (Profile Screen)
- **기능**: 사용자 정보 관리 및 설정
- **표시 정보**: 닉네임, 이메일, 씨앗, 출석 정보
- **편집 기능**: 닉네임 변경
- **설정**: 앱 설정, 도움말, 로그아웃

---

## 2. API 명세서

### 2.1 인증 API

#### POST /auth/signup
- **설명**: 사용자 회원가입
- **요청**:
  ```json
  {
    "email": "string (선택사항)",
    "password": "string (선택사항)",
    "nickname": "string",
    "social_type": "string (선택사항)",
    "social_id": "string (선택사항)"
  }
  ```
- **응답**:
  ```json
  {
    "access_token": "string",
    "token_type": "bearer"
  }
  ```

#### POST /auth/login
- **설명**: 사용자 로그인
- **요청**:
  ```json
  {
    "email": "string",
    "password": "string"
  }
  ```
- **응답**:
  ```json
  {
    "access_token": "string",
    "token_type": "bearer"
  }
  ```

### 2.2 사용자 API

#### GET /users/me
- **설명**: 현재 사용자 정보 조회
- **헤더**: `Authorization: Bearer {token}`
- **응답**:
  ```json
  {
    "id": "integer",
    "nickname": "string",
    "email": "string",
    "social_type": "string",
    "is_developer": "boolean",
    "created_at": "datetime"
  }
  ```

#### PUT /users/me
- **설명**: 사용자 정보 수정
- **헤더**: `Authorization: Bearer {token}`
- **요청**:
  ```json
  {
    "nickname": "string (선택사항)",
    "password": "string (선택사항)"
  }
  ```
- **응답**: GET /users/me와 동일

#### DELETE /users/me
- **설명**: 회원 탈퇴
- **헤더**: `Authorization: Bearer {token}`
- **응답**:
  ```json
  {
    "detail": "회원 탈퇴가 완료되었습니다."
  }
  ```

### 2.3 감정 기록 API

#### POST /records/
- **설명**: 일기 작성 및 감정 분석
- **헤더**: `Authorization: Bearer {token}`
- **요청**:
  ```json
  {
    "content": "string",
    "sleep_score": "integer (1-10, 선택사항)",
    "stress_score": "integer (1-10, 선택사항)",
    "share_with_counselor": "boolean"
  }
  ```
- **응답**:
  ```json
  {
    "id": "integer",
    "content": "string",
    "sleep_score": "integer",
    "stress_score": "integer",
    "ai_keywords": ["string"],
    "ai_summary": "string",
    "emotion_analysis": "object",
    "share_with_counselor": "boolean",
    "created_at": "datetime"
  }
  ```

#### GET /records/weekly/summary
- **설명**: 주간 감정 요약 조회
- **헤더**: `Authorization: Bearer {token}`
- **쿼리 파라미터**:
  - `period`: 분석 기간 (기본값: 7)
- **응답**:
  ```json
  {
    "period": "integer",
    "items": ["object"],
    "one_line_summary": "string",
    "negative_ratio": "float",
    "updated_at": "datetime"
  }
  ```

### 2.4 정원 시스템 API

#### GET /garden/info
- **설명**: 사용자 정원 정보 조회
- **헤더**: `Authorization: Bearer {token}`
- **응답**:
  ```json
  {
    "seeds": "integer",
    "attendance_streak": "integer",
    "last_attendance_date": "datetime",
    "garden_items": ["object"]
  }
  ```

#### POST /garden/attendance
- **설명**: 출석 체크 및 씨앗 획득
- **헤더**: `Authorization: Bearer {token}`
- **응답**:
  ```json
  {
    "message": "string",
    "seeds_earned": "integer",
    "current_seeds": "integer",
    "attendance_streak": "integer"
  }
  ```

#### GET /garden/shop
- **설명**: 상점 아이템 목록 조회
- **응답**:
  ```json
  {
    "items": ["object"]
  }
  ```

#### POST /garden/purchase/{template_id}
- **설명**: 상점 아이템 구매
- **헤더**: `Authorization: Bearer {token}`
- **쿼리 파라미터**:
  - `quantity`: 구매 수량 (기본값: 1)
- **응답**:
  ```json
  {
    "success": "boolean",
    "message": "string",
    "remaining_seeds": "integer",
    "purchased_item": "object"
  }
  ```

#### POST /garden/equip/{item_id}
- **설명**: 정원에 아이템 배치
- **헤더**: `Authorization: Bearer {token}`
- **쿼리 파라미터**:
  - `position_x`: X 좌표
  - `position_y`: Y 좌표
  - `variant`: 변형 선택 (선택사항)
- **응답**:
  ```json
  {
    "success": "boolean",
    "message": "string"
  }
  ```

#### POST /garden/unequip/{item_id}
- **설명**: 정원에서 아이템 제거
- **헤더**: `Authorization: Bearer {token}`
- **응답**:
  ```json
  {
    "success": "boolean",
    "message": "string"
  }
  ```

#### GET /garden/inventory
- **설명**: 사용자 인벤토리 조회
- **헤더**: `Authorization: Bearer {token}`
- **응답**:
  ```json
  {
    "inventory": ["object"]
  }
  ```

### 2.5 감정 분석 API

#### GET /emotions/colors
- **설명**: 감정 색상 정보 조회
- **헤더**: `Authorization: Bearer {token}`
- **응답**:
  ```json
  {
    "emotion_colors": "object",
    "description": "string"
  }
  ```

#### GET /emotions/analyze
- **설명**: 텍스트 감정 분석 (테스트용)
- **헤더**: `Authorization: Bearer {token}`
- **쿼리 파라미터**:
  - `text`: 분석할 텍스트
- **응답**: 감정 분석 결과

#### GET /emotions/analyze-ai
- **설명**: AI 기반 텍스트 감정 분석
- **헤더**: `Authorization: Bearer {token}`
- **쿼리 파라미터**:
  - `text`: 분석할 텍스트
- **응답**: AI 감정 분석 결과

**AI 감정 분석 응답 예시:**
```json
{
  "primary_emotion": "슬픔",
  "intensity": 8,
  "confidence": 0.95,
  "reasoning": "텍스트에서 '힘들었다', '죽고싶다' 표현이 깊은 슬픔과 절망감을 나타냄",
  "color": {
    "name": "어두운 파랑",
    "hex": "#000046",
    "rgb": [0, 0, 70],
    "description": "슬픔의 원색",
    "intensity": 8
  },
  "message": "오늘의 감정색은 어두운 파랑입니다~ (AI 분석)",
  "ai_used": true,
  "ai_failed": false
}
```

#### GET /emotions/summarize
- **설명**: 텍스트 요약
- **헤더**: `Authorization: Bearer {token}`
- **쿼리 파라미터**:
  - `text`: 요약할 텍스트
- **응답**:
  ```json
  {
    "original_text": "string",
    "summary": "string",
    "ai_used": "boolean"
  }
  ```

### 2.6 알림 및 상담 API

#### GET /alerts/check
- **설명**: 위험 신호 알림 확인
- **헤더**: `Authorization: Bearer {token}`
- **응답**:
  ```json
  {
    "should_alert": "boolean",
    "period": "integer",
    "negative_ratio": "float",
    "days_negative": "integer",
    "message": "string",
    "form_url": "string"
  }
  ```

#### GET /alerts/test/force-show
- **설명**: 테스트용 강제 알림 표시 (개발자 전용)
- **헤더**: `Authorization: Bearer {token}`
- **응답**: GET /alerts/check와 동일 + `"is_test": true`

### 2.7 음성 인식 API

#### POST /voice/transcribe
- **설명**: 음성 파일을 텍스트로 변환
- **헤더**: `Authorization: Bearer {token}`
- **요청**: `multipart/form-data` (audio 파일)
- **응답**:
  ```json
  {
    "text": "string",
    "confidence": "float"
  }
  ```

### 2.8 상담 보고서 API

#### GET /reports/shared
- **설명**: 공유된 상담 보고서 조회
- **헤더**: `Authorization: Bearer {token}`
- **응답**:
  ```json
  {
    "reports": ["object"]
  }
  ```

#### POST /reports/share
- **설명**: 효원 상담원과 보고서 공유
- **헤더**: `Authorization: Bearer {token}`
- **요청**:
  ```json
  {
    "record_id": "integer",
    "counselor_email": "string"
  }
  ```
- **응답**:
  ```json
  {
    "success": "boolean",
    "message": "string"
  }
  ```

---

## 앱 화면별 상세 설명

### 로그인 화면
**기능**: 사용자 인증 및 로그인
**입력 요소**: 이메일, 비밀번호
**유효성 검사**: 실시간 입력 검증, 로그인 버튼 활성화/비활성화
**에러 처리**: 계정 없음, 비밀번호 오류 등 명확한 피드백

### 홈 화면
**기능**: 메인 네비게이션 및 사용자 정보 표시
**구성 요소**: 사용자 닉네임, 씨앗 정보, 빠른 액세스 버튼
**애니메이션**: 페이드인, 슬라이드, 바운스 효과로 부드러운 전환

### 일기 작성 화면
**기능**: 감정 기록 및 AI 분석
**입력 요소**: 수면 품질 슬라이더, 스트레스 정도 슬라이더, 일기 내용
**특별 기능**: 음성 입력 지원, 실시간 유효성 검사
**AI 분석**: 작성 완료 시 자동 감정 분석 시작

### 일기 작성 결과 화면
**기능**: AI 분석 결과 표시
**표시 내용**: 감정 색상, 키워드, 요약, 신뢰도 점수
**시각화**: 감정을 색상으로 직관적 표현
**공유 옵션**: 상담사와의 공유 동의 설정

### 감정 분석 화면
**기능**: 감정 변화 추이 및 통계
**차트 유형**: 7일 변화 그래프, 감정 분포 파이 차트, 월간 통계
**필터링**: 기간별, 감정별 분석
**인사이트**: 감정 패턴 및 변화 추이 제공

### 마음 정원 화면
**기능**: 게임형 마음 건강 관리
**정원 탭**: 6x12 그리드로 정원 꾸미기
**내 씨앗 탭**: 출석 체크로 씨앗 획득, 연속 출석 보너스
**상점 탭**: 씨앗으로 다양한 아이템 구매
**인벤토리 탭**: 보유 아이템 관리 및 정원 배치

### 마음 체크 화면
**기능**: 효원 상담원 연결 및 위험 신호 알림
**상담 연결**: Google Forms 기반 상담 신청
**알림 시스템**: 7일 부정 감정 지속 시 "마음이 오랫동안 비를 맞고 있을 때" 알림
**동의 옵션**: "동의 없이 바로가기" / "동의하고 바로가기"

### 프로필 화면
**기능**: 사용자 정보 관리 및 설정
**표시 정보**: 닉네임, 이메일, 씨앗, 출석 정보
**편집 기능**: 닉네임 변경
**설정**: 앱 설정, 도움말, 로그아웃

---

*이 기능 명세서는 SimLog 프로젝트의 화면별 기능과 API 명세를 상세히 설명합니다.*
