# SimLog (심로그) 🌸

**심리 감정 기록 및 AI 분석 플랫폼**

감정 표현이 서툰 청년층을 위한 비대면·비실명 감정 기록 및 AI 기반 피드백 시스템

---

## 🚀 주요 기능 (2025-08-09 기준)

### 📝 감정 기록
- **텍스트/음성 입력**: 자유로운 감정 표현
  - **웹/모바일 음성인식**: MediaRecorder API (웹) + record 패키지 (모바일)
  - **Naver Clova STT 연동**: 실시간 음성-텍스트 변환
- **AI 키워드 추출/요약**: GPT-4o mini 기반 자동 분석
- **감정 강도/신뢰도 입력**: 1~10점
- **하루 1회 기록 제한(일반)**
- **일기 작성 시 씨앗 지급**: 감정 기록할 때마다 +2 씨앗

### 🎨 감정 분석
- **감정 분포/통계**: 최근 7/14/30일 감정 분포, 평균 감정색
- **대표 감정색(플루치크 확장 팔레트)**: 8가지 기본 감정 + 인접 2차 감정 조합(사랑, 경외, 실망 등) 중에서 선택, 강도에 따라 명도/채도 반영
- **감정 키워드/요약/색상**: AI가 분석한 결과를 시각적으로 표시

### 🌱 마음 정원
- **씨앗(화폐) 시스템**: 출석 체크(+2), 일기 작성(+2), 연속 출석 보너스
- **출석 체크**: 매일 출석하여 씨앗 획득, 연속 출석 시 추가 보너스
- **상점 시스템**: 씨앗으로 정원 아이템 구매 (꽃, 화분, 장식)
- **인벤토리 관리**: 구매한 아이템 관리 및 정원 배치, 아이템 판매 기능
- **정원 커스터마이징**: 개인만의 정원 꾸미기, 4단계 레이어링 시스템
- **감정 꽃 시각화**: 기록한 감정을 꽃으로 표현
- **레이어링 시스템**: 배경(0) → 중간(1) → 식물(2) → 동물(3) 순서로 배치
- **레이어 조정**: 돌담/벽돌/원형 벽돌을 중간(1) 레이어로 정리, 상점 표시에서 레이어/희귀도 라벨 제거
- **조건부 배경색**: 연못 위의 아이템들은 연못색 배경으로 자연스러운 효과

### 👤 사용자 정보 관리
- **닉네임/비밀번호 변경**: 내 정보 수정에서 API 연동으로 즉시 변경
- **반응형 프로필 화면**: 스크롤 지원, 태블릿/모바일 최적화
- **앱 설정/알림 설정/도움말**
- **마음 체크하기**: 효원 상담원 마음체크 안내 및 폼 바로가기, 최근 7일 요약 링크 생성 버튼 제공
- **Pretendard 폰트 적용**: 전체 앱 기본 폰트로 적용

### 🧭 네비게이션 & UX
- **하단 네비게이션 바**: 텍스트 라벨 제거, 아이콘 확대(가독성 향상)
- **플로팅 +버튼**: 일기 작성 바로가기
- **반응형 디자인**: 화면 크기에 따른 폰트/아이콘 크기 자동 조정
- **향상된 가독성**: 홈화면 폰트 크기 증대, 사용자 경험 개선

---

## 🛠 기술 스택

### Backend
- **FastAPI** (Python)
- **MySQL** + **SQLAlchemy**
- **JWT 인증**
- **OpenAI GPT-4o mini** (AI 분석)
- **NAVER CLOVA** (음성 인식)

### Frontend
- **Flutter** (Dart)
- **모바일/웹/데스크탑 지원**
- **HTTP API 연동**
- **웹 음성인식**: MediaRecorder API, WebM 지원
- **모바일 음성인식**: record 패키지, WAV 지원
- **Pretendard 폰트**: 한국어 최적화 폰트 시스템

---

## 🏗 프로젝트 구조

```
SimLog/
├── backend/                 # FastAPI 백엔드
│   ├── controllers/         # API 엔드포인트
│   ├── models/              # DB 모델
│   ├── services/            # 비즈니스 로직
│   ├── main.py              # 진입점
│   ├── migrate_db.py        # 기본 DB 마이그레이션
│   ├── migrate_garden.py    # 정원 시스템 마이그레이션
│   └── requirements.txt     # 의존성
├── frontend/                # Flutter 프론트엔드
│   ├── lib/screens/         # 주요 화면
│   ├── lib/services/        # API 연동 (음성인식 포함)
│   ├── assets/fonts/        # MaruBuri 폰트 파일
│   └── pubspec.yaml         # Flutter 의존성
└── docs/                    # 문서
    ├── 음성인식_설정_가이드.md    # Clova STT 설정 가이드
    └── 레이어링_시스템_가이드.md  # 정원 레이어링 시스템
```

---

## ⚡️ 실행 방법

### 1. 백엔드
```bash
cd backend
pip install -r requirements.txt
# .env 파일 설정 (DB, OPENAI, CLOVA 등)
# CLOVA_CLIENT_ID, CLOVA_CLIENT_SECRET 설정 필수
python migrate_db.py
python migrate_garden.py  # 정원 시스템 마이그레이션
python add_all_garden_items.py  # 정원 아이템 데이터 추가
python create_developer.py
uvicorn main:app --reload
```

### 2. 프론트엔드 (Flutter)
```bash
cd frontend
flutter pub get
# 모바일: flutter run
# 웹 (음성인식 테스트): flutter run -d chrome
# 웹 (포트 지정): flutter run -d chrome --web-port=3000
```

### 3. 음성인식 설정 (선택사항)
- Naver Cloud Platform에서 Clova STT API 키 발급
- `backend/.env` 파일에 `CLOVA_CLIENT_ID`, `CLOVA_CLIENT_SECRET` 설정
- 자세한 설정 방법: `docs/음성인식_설정_가이드.md` 참조

---

## 📱 주요 화면
- **Splash/인트로**: 1초 후 자동 로그인 화면 이동
- **로그인/회원가입**: JWT 인증, 성공 시 홈 이동
- **홈**: 4개 액션 카드(일기 작성, 분석, 정원, 내 정보)
- **분석**: 감정 통계, 분포, 평균 감정색, 최근 기록, 상세보기
- **정원**: 
  - **정원 탭**: 씨앗 표시, 출석 체크, 정원 아이템, 감정 꽃들
  - **상점 탭**: 씨앗으로 아이템 구매 (꽃, 화분, 장식)
  - **인벤토리 탭**: 구매한 아이템 관리 및 정원 배치
- **내 정보**: 프로필, 내 정보 수정(닉네임/비밀번호), 앱/알림/도움말
- **마음 체크하기**: 안내/폼 이동, 최근 7일 요약 링크 생성
- **일기 작성/결과**: 감정 기록 입력, AI 분석 결과 확인

---

## 🧑‍💻 개발 현황 (2025-08-09)

### ✅ 완료
- [x] 백엔드/프론트엔드 기본 구조
- [x] JWT 인증/회원가입/로그인
- [x] 감정 기록/분석/상세보기
- [x] AI 기반 감정 분석/요약/키워드/색상
- [x] 평균 감정색 AI+캐싱(동일 기간 내 재사용)
- [x] 프로필(닉네임/비밀번호) 수정 API 연동
- [x] 네비게이션/플로팅버튼/화면 전환
- [x] 앱/알림/도움말 더미 페이지
- [x] **씨앗(화폐) 시스템**: 출석 체크, 일기 작성 시 씨앗 지급
- [x] **정원 시스템**: 상점, 인벤토리, 아이템 배치/제거
- [x] **출석 체크**: 연속 출석 보너스, 씨앗 획득
- [x] **상점 시스템**: 꽃, 화분, 장식 아이템 구매
- [x] **인벤토리 관리**: 아이템 관리 및 정원 커스터마이징
- [x] **음성인식 시스템**: Naver Clova STT 연동 (웹/모바일)
- [x] **웹 음성인식**: MediaRecorder API, WebM 지원
- [x] **모바일 음성인식**: record 패키지, WAV 지원
- [x] **반응형 UI**: 스크롤 지원, 태블릿/모바일 최적화
- [x] **Pretendard 폰트**: 한국어 최적화 폰트 시스템
- [x] **UX 개선**: 홈화면 가독성 향상, 폰트 크기 조정
- [x] **하단 네비게이션 개선**: 텍스트 라벨 제거, 아이콘 확대
- [x] **상점 표시 정리**: 레이어/희귀도 라벨 제거
- [x] **정원 레이어 조정**: 돌담/벽돌/원형 벽돌 → 중간(1)
- [x] **웹 녹음/업로드 호환**: audio/webm 업로드 허용, STT 언어 코드(Kor) 매핑
- [x] **AI 음성인식 웹 지원**: MediaRecorder 기반, 백엔드 WebM 허용
- [x] **주간 요약 캐시**: 일기 저장 즉시 7일 큐 자동 갱신
- [x] **부정 감정 알림**: 1~2주 부정 지속 시 다정한 모달 + 폼 링크
- [x] **공유 링크(7일 만료)**: 최근 7일 요약 스냅샷 공유, 토큰 해시 저장·만료/취소 지원
- [x] **모달 7일 억제**: 마음체크 수행 시 7일간 모달 미표시
- [x] **마음 체크하기 화면**: 폼 이동 + “최근 7일 요약 링크 생성” 버튼 추가

### 🔄 진행 중
- WebM → WAV 오디오 변환 최적화
- 음성인식 정확도 개선
- 상담소 연동/자가진단(확장 예정)

### 🆕 최근 업데이트 (2025-08-09)
- ✅ **대표 감정색 개선**: 플루치크 확장 팔레트(2차 감정) 기반 대표색 선택
- ✅ **정원 레이어링/상점 라벨 정리**: 돌담/벽돌/원형 벽돌 레이어 조정, 레이어/희귀도 라벨 제거
- ✅ **폰트 교체**: Pretendard로 통일, 가독성 향상
- ✅ **웹 STT 지원 강화**: audio/webm 허용, 언어 코드(Kor) 고정
- ✅ **부정 감정 모달 + 7일 억제**: 동의/폼 이동 시 7일간 모달 방지
- ✅ **마음 체크하기 화면 확장**: 최근 7일 요약 링크 생성 버튼 추가

---

## 🤝 기여하기
1. Fork & Branch
2. 기능 개발 후 PR
3. 코드리뷰/병합

---

## 📞 문의
- [프로젝트 깃허브](https://github.com/wlsgur11/SimLog)

---

**SimLog** - 당신의 감정을 아름답게 기록하세요 🌸 